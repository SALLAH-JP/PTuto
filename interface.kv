<MyScreenManager>:
    AccueilScreen:
    SimulationScreen:
    RobotScreen:
    OptionsScreen:

<AccueilScreen>:
    name: "accueil"
    MDBoxLayout:
        orientation: "vertical"
        spacing: dp(20)
        padding: dp(50)

        canvas.before:
            Rectangle:
                source: "assets/backgrounds/background.jpg"
                pos: self.pos
                size: self.size

        MDLabel:
            text: "Bienvenue sur le Simulateur de Robot"
            font_style: "H4"
            halign: "center"
            theme_text_color: "Primary"

        MDRaisedButton:
            text: "Démarrer la simulation"
            size_hint: (0.6, 0.15)
            pos_hint: {"center_x": 0.5}
            on_release: root.on_simuler_pressed()

        MDRaisedButton:
            text: "Connecter un robot"
            size_hint: (0.6, 0.15)
            pos_hint: {"center_x": 0.5}
            on_release: app.root.current = "robot"

        MDRaisedButton:
            text: "Options et paramètres"
            size_hint: (0.6, 0.15)
            pos_hint: {"center_x": 0.5}
            on_release: app.root.current = "options"

<SimulationScreen>:
    name: "simulation"

    canvas.before:
        Rectangle:
            source: "assets/backgrounds/plage.jpg"
            pos: self.pos
            size: self.size

    MDBoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        Widget:
            id: simulation_widget

        MDRaisedButton:
            text: "Générer des déchets"
            size_hint: 0.2, 0.1
            pos_hint: {"center_x": 0.5}
            on_release: root.generate_dechets()

        MDRaisedButton:
            text: "Retour à l'accueil"
            size_hint: 0.2, 0.1
            pos_hint: {"center_x": 0.5}
            on_release: app.root.current = "accueil"

<RobotScreen>:
    name: "robot"

    MDBoxLayout:
        orientation: 'horizontal'
        padding: dp(20)
        spacing: dp(10)

        MDCard:
            elevation: 8
            radius: dp(15)
            size_hint: 0.2, None
            height: dp(150)
            MDLabel:
                text: "Robot connecté"
                halign: "center"

        # Partie droite : Formulaire de connexion
        MDBoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.4
            padding: dp(20)
            spacing: dp(10)

            MDLabel:
                text: "Connexion au Robot"
                font_style: "H5"
                halign: "center"

            MDTextField:
                id: ip_input
                hint_text: "Entrez l'adresse IP"

            MDTextField:
                id: port_input
                hint_text: "Entrez le port COM"

            MDLabel:
                id: status_label
                text: "Statut : Déconnecté"
                theme_text_color: "Error"

            MDRaisedButton:
                text: "Connecter"
                on_release: root.connect_robot(ip_input.text, port_input.text)

            MDRaisedButton:
                text: "Retour à l'accueil"
                on_release: app.root.current = "accueil"

<OptionsScreen>:
    name: "options"

    MDBoxLayout:
        orientation: "vertical"
        padding: dp(20)
        spacing: dp(10)

        MDLabel:
            text: "Options et Paramètres"
            font_style: "H5"
            halign: "center"

        MDGridLayout:
            cols: 2
            spacing: dp(10)

            MDLabel:
                text: "Nombre de déchets :"
                halign: "right"
            MDTextField:
                id: nb_dechets
                hint_text: "Entrez le nombre"

            MDLabel:
                text: "Largeur de la plage (m) :"
                halign: "right"
            MDTextField:
                id: largeur_plage
                hint_text: "Entrez la largeur"

            MDLabel:
                text: "Longueur de la plage (m) :"
                halign: "right"
            MDTextField:
                id: longueur_plage
                hint_text: "Entrez la longueur"

            MDLabel:
                text: "Taux de recyclage (%) :"
                halign: "right"
            MDTextField:
                id: taux_recyclage
                hint_text: "Entrez le taux"

            MDLabel:
                text: "Vitesse de simulation :"
                halign: "right"
            MDTextField:
                id: vitesse_simulation
                hint_text: "Entrez la vitesse"

        MDRaisedButton:
            text: "Enregistrer les paramètres"
            size_hint_y: 0.1
            on_release: root.enregistrer_parametres()

        MDRaisedButton:
            text: "Retour à l'accueil"
            size_hint_y: 0.1
            on_release: app.root.current = "accueil"